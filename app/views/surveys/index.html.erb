<% content_for :title, "Personalization Survey" %>

<div class="container-fluid">
  <div class="survey-container d-flex justify-content-center align-items-center">
    <%= render 'welcome_modal' if show_welcome_modal? %>
    
    <div class="card shadow survey-card">
      <div class="card-header bg-warning text-dark">
        <h2 class="h4 mb-0">Basic Personalization Survey</h2>
      </div>

      <div class="card-body">
        <div class="progress mb-4">
          <div class="progress-bar bg-primary" 
               role="progressbar" 
               data-survey-target="progress"
               style="width: <%= @progress %>%"
               aria-valuenow="<%= @progress %>" 
               aria-valuemin="0" 
               aria-valuemax="100">
          </div>
        </div>

        <%= form_with url: surveys_path(type: @survey_type), 
                      local: false, 
                      html: { 
                        id: "survey-form",
                        class: "survey-form",
                        data: { 
                          controller: "survey",
                          survey_type: @survey_type
                        }
                      } do |form| %>
          
          <%= render 'question_section', form: form, questions: @personality_questions %>
          <%= render 'genre_selection', form: form, genres: @genres %>
          <%= render 'survey_navigation', survey_type: @survey_type %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<%= render 'survey_completion_modal' %>
